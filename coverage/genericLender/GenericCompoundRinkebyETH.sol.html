<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for genericLender/GenericCompoundRinkebyETH.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">genericLender/</a> GenericCompoundRinkebyETH.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/57</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/18</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/17</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/57</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: GNU GPLv3
&nbsp;
pragma solidity ^0.8.2;
&nbsp;
import "../interfaces/external/compound/CEtherI.sol";
import "../interfaces/external/compound/InterestRateModel.sol";
import "../interfaces/external/uniswap/IUniswapV3Router.sol";
&nbsp;
import "./GenericLenderBase.sol";
&nbsp;
interface IWETH is IERC20 {
    function withdraw(uint256 wad) external;
&nbsp;
    function deposit() external payable;
}
&nbsp;
/// @title GenericCompound
/// @author Forked from https://github.com/Grandthrax/yearnv2/blob/master/contracts/GenericDyDx/GenericCompound.sol
/// @notice A contract to lend any ERC20 to Compound
/// @dev This contract is the Rinkeby version of `GenericCompound`, it differs in the `apr` function
contract GenericCompoundRinkebyETH is GenericLenderBase {
    using SafeERC20 for IERC20;
    using Address for address;
&nbsp;
    uint256 public constant BLOCKS_PER_YEAR = 2_300_000;
&nbsp;
    // ==================== References to contracts =============================
&nbsp;
    address public uniswapRouter;
    address public comp;
    CEtherI public cToken;
&nbsp;
    // ==================== Parameters =============================
&nbsp;
    bytes public path;
    uint256 public minCompToSell = 0.5 ether;
&nbsp;
    // ============================= Constructor =============================
&nbsp;
    /// @notice Constructor of the GenericLenderBase
    /// @param _strategy Reference to the strategy using this lender
    /// @param _uniswapRouter Uniswap router interface to swap reward tokens
    /// @param _comp Address of the comp token
    /// @param _path Bytes to encode the swap from comp to want
    /// @param _cToken Address of the cToken
    /// @param governorList List of addresses with governor privilege
    /// @param guardian Address of the guardian
<span class="fstat-no" title="function not covered" >    constructor(</span>
        address _strategy,
        string memory name,
        address _uniswapRouter,
        address _comp,
        bytes memory _path,
        address _cToken,
        address[] memory governorList,
        address guardian
    ) GenericLenderBase(_strategy, name, governorList, guardian) {
<span class="cstat-no" title="statement not covered" >        require(address(_comp) != address(0) &amp;&amp; address(_strategy) != address(0), "zero address")</span>;
<span class="cstat-no" title="statement not covered" >        uniswapRouter = _uniswapRouter</span>;
<span class="cstat-no" title="statement not covered" >        comp = _comp</span>;
<span class="cstat-no" title="statement not covered" >        path = _path</span>;
<span class="cstat-no" title="statement not covered" >        cToken = CEtherI(_cToken)</span>;
<span class="cstat-no" title="statement not covered" >        IERC20(comp).safeApprove(address(_uniswapRouter), type(uint256).max)</span>;
    }
&nbsp;
    // ===================== External Strategy Functions ===========================
&nbsp;
    /// @notice Deposits the current balance to the lending platform
<span class="fstat-no" title="function not covered" >    function deposit() external override onlyRole(STRATEGY_ROLE) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 balance = IWETH(address(want)).balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >        IWETH(address(want)).withdraw(balance)</span>;
<span class="cstat-no" title="statement not covered" >        cToken.mint{ value: balance }()</span>;
    }
&nbsp;
    /// @notice Withdraws a given amount from lender
    /// @param amount The amount the caller wants to withdraw
    /// @return The amounts actually withdrawn
<span class="fstat-no" title="function not covered" >    function withdraw(uint256 amount) external override onlyRole(STRATEGY_ROLE) returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _withdraw(amount);</span>
    }
&nbsp;
    /// @notice Withdraws as much as possible
    /// @return Whether everything was withdrawn or not
<span class="fstat-no" title="function not covered" >    function withdrawAll() external override onlyRole(STRATEGY_ROLE) returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 invested = _nav();</span>
<span class="cstat-no" title="statement not covered" >        uint256 returned = _withdraw(invested);</span>
<span class="cstat-no" title="statement not covered" >        return returned &gt;= invested;</span>
    }
&nbsp;
    // ============================= External View Functions =============================
&nbsp;
    /// @notice Helper function to get the current total of assets managed by the lender.
<span class="fstat-no" title="function not covered" >    function nav() external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _nav();</span>
    }
&nbsp;
    /// @notice Helper function the current balance of cTokens
<span class="fstat-no" title="function not covered" >    function underlyingBalanceStored() public view returns (uint256 balance) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 currentCr = cToken.balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >        if (currentCr == 0) {</span>
<span class="cstat-no" title="statement not covered" >            balance = 0</span>;
        } else {
            //The current exchange rate as an unsigned integer, scaled by 1e18.
<span class="cstat-no" title="statement not covered" >            balance = (currentCr * cToken.exchangeRateStored()) / 1e18</span>;
        }
    }
&nbsp;
    /// @notice Returns an estimation of the current Annual Percentage Rate
<span class="fstat-no" title="function not covered" >    function apr() external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _apr();</span>
    }
&nbsp;
    /// @notice Returns an estimation of the current Annual Percentage Rate weighted by a factor
<span class="fstat-no" title="function not covered" >    function weightedApr() external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 a = _apr();</span>
<span class="cstat-no" title="statement not covered" >        return a * _nav();</span>
    }
&nbsp;
    /// @notice Returns an estimation of the current Annual Percentage Rate after a new deposit
    /// @param amount The amount to add to the lending platform
<span class="fstat-no" title="function not covered" >    function aprAfterDeposit(uint256 amount) external view override returns (uint256) {</span>
        // Rinkeby version
<span class="cstat-no" title="statement not covered" >        return _apr();</span>
    }
&nbsp;
    /// @notice Check if any assets is currently managed by this contract
<span class="fstat-no" title="function not covered" >    function hasAssets() external view override returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        return cToken.balanceOf(address(this)) &gt; 0 || IWETH(address(want)).balanceOf(address(this)) &gt; 0;</span>
    }
&nbsp;
    // ============================= Governance =============================
&nbsp;
    /// @notice Sets the path for the swap of COMP tokens
    /// @param _path New path
<span class="fstat-no" title="function not covered" >    function setPath(bytes memory _path) external onlyRole(GUARDIAN_ROLE) {</span>
<span class="cstat-no" title="statement not covered" >        path = _path</span>;
    }
&nbsp;
    /// @notice Withdraws as much as possible in case of emergency and sends it to the poolManager
    /// @param amount Amount to withdraw
    /// @dev Does not check if any error occurs or the amount withdrawn
<span class="fstat-no" title="function not covered" >    function emergencyWithdraw(uint256 amount) external override onlyRole(GUARDIAN_ROLE) {</span>
        // Don't care about errors here. we want to exit what we can
<span class="cstat-no" title="statement not covered" >        cToken.redeemUnderlying(amount)</span>;
<span class="cstat-no" title="statement not covered" >        IWETH(address(want)).withdraw(address(this).balance)</span>;
<span class="cstat-no" title="statement not covered" >        want.safeTransfer(address(poolManager), IWETH(address(want)).balanceOf(address(this)))</span>;
    }
&nbsp;
    // ============================= Internal Functions =============================
&nbsp;
    /// @notice See 'apr'
<span class="fstat-no" title="function not covered" >    function _apr() internal view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return cToken.supplyRatePerBlock() * BLOCKS_PER_YEAR;</span>
    }
&nbsp;
    /// @notice See 'nav'
<span class="fstat-no" title="function not covered" >    function _nav() internal view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return IWETH(address(want)).balanceOf(address(this)) + underlyingBalanceStored();</span>
    }
&nbsp;
    /// @notice See 'withdraw'
<span class="fstat-no" title="function not covered" >    function _withdraw(uint256 amount) internal returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 balanceUnderlying = cToken.balanceOfUnderlying(address(this));</span>
<span class="cstat-no" title="statement not covered" >        uint256 looseBalance = IWETH(address(want)).balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >        uint256 total = balanceUnderlying + looseBalance;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (amount &gt; total) {</span>
            //cant withdraw more than we own
<span class="cstat-no" title="statement not covered" >            amount = total</span>;
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (looseBalance &gt;= amount) {</span>
<span class="cstat-no" title="statement not covered" >            want.safeTransfer(address(strategy), amount)</span>;
<span class="cstat-no" title="statement not covered" >            return amount;</span>
        }
&nbsp;
        //not state changing but OK because of previous call
<span class="cstat-no" title="statement not covered" >        uint256 liquidity = want.balanceOf(address(cToken));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (liquidity &gt; 1) {</span>
<span class="cstat-no" title="statement not covered" >            uint256 toWithdraw = amount - looseBalance;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (toWithdraw &lt;= liquidity) {</span>
                //we can take all
<span class="cstat-no" title="statement not covered" >                require(cToken.redeemUnderlying(toWithdraw) == 0, "redeemUnderlying fail")</span>;
<span class="cstat-no" title="statement not covered" >                IWETH(address(want)).deposit{ value: address(this).balance }()</span>;
            } else {
                //take all we can
<span class="cstat-no" title="statement not covered" >                require(cToken.redeemUnderlying(liquidity) == 0, "redeemUnderlying fail")</span>;
<span class="cstat-no" title="statement not covered" >                IWETH(address(want)).deposit{ value: address(this).balance }()</span>;
            }
        }
<span class="cstat-no" title="statement not covered" >        _disposeOfComp()</span>;
<span class="cstat-no" title="statement not covered" >        looseBalance = want.balanceOf(address(this))</span>;
<span class="cstat-no" title="statement not covered" >        want.safeTransfer(address(strategy), looseBalance)</span>;
<span class="cstat-no" title="statement not covered" >        return looseBalance;</span>
    }
&nbsp;
    /// @notice Claims and swaps to Uniswap the Comp earned
<span class="fstat-no" title="function not covered" >    function _disposeOfComp() internal {</span>
<span class="cstat-no" title="statement not covered" >        uint256 _comp = IERC20(comp).balanceOf(address(this));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (_comp &gt; minCompToSell) {</span>
<span class="cstat-no" title="statement not covered" >            IUniswapV3Router(uniswapRouter).exactInput(</span>
                ExactInputParams(path, address(this), block.timestamp, _comp, uint256(0))
            );
        }
    }
&nbsp;
    /// @notice Specifies the token managed by this contract during normal operation
<span class="fstat-no" title="function not covered" >    function _protectedTokens() internal view override returns (address[] memory) {</span>
<span class="cstat-no" title="statement not covered" >        address[] memory protected = new address[](3);</span>
<span class="cstat-no" title="statement not covered" >        protected[0] = address(want)</span>;
<span class="cstat-no" title="statement not covered" >        protected[1] = address(cToken)</span>;
<span class="cstat-no" title="statement not covered" >        protected[2] = comp</span>;
<span class="cstat-no" title="statement not covered" >        return protected;</span>
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Sep 07 2021 10:03:31 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
